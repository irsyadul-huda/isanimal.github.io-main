<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matematic Game</title>
  <link rel="icon" href="logo.png" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet">
  <style>
    :root {
      --btn-font-size: clamp(14px, 2vw, 20px);
      --btn-padding-y: clamp(10px, 2vw, 16px);
      --btn-padding-x: clamp(22px, 6vw, 42px);
      --btn-radius: 36px;
      --audio-btn-bg: rgba(255, 255, 255, 0.856);
      --audio-btn-shadow: 0 3px 8px rgba(0,0,0,0.13), 0 0 0 2px #fffbe4;
      --audio-btn-radius: 50%;
      --audio-btn-size: clamp(28px, 7vw, 46px);
      --volume-slider-orange-dark: #ffe3be;
      --volume-slider-orange-dark-light: #e29120;
    }
    html, body {
      font-family: 'Poppins', Arial, Helvetica, sans-serif !important;
      font-weight: 700 !important;
      overflow: hidden !important;
      height: 100%;
      margin: 0;
      padding: 0;
      max-width: 100vw;
    }
    body {
      background: url('asset/bg-home.png') no-repeat center center fixed;
      background-size: cover;
      opacity: 1;
      transition: opacity 0.7s cubic-bezier(.44,.05,.54,1);
    }
    .fadein-body-init { opacity: 0 !important; }
    .falling-leaves-container {
      pointer-events: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      overflow: visible !important;
    }
    .leaf {
      position: absolute;
      width: 36px;
      height: 38px;
      opacity: .88;
      pointer-events: none;
      will-change: transform, opacity;
      user-select: none;
    }
    .leaf.dry svg .leafShape { fill: #C19A6B; stroke: #a07246; }
    .leaf.green svg .leafShape { fill: #7BC162; stroke: #3a8035; }
    .leaf.red svg .leafShape { fill: #e04d22; stroke: #b7330a; }
    .leaf.orange svg .leafShape { fill: #fbb040; stroke: #f06600; }
    .leaf.yellow svg .leafShape { fill: #ffe644; stroke: #e7c100; }
    .leaf.purple svg .leafShape { fill: #b589db; stroke: #7551a7; }
    .leaf.banana svg .leafShape { fill: #b4ef8a; stroke: #689d30; }
    .leaf.monstera svg .leafShape { fill: #21b573; stroke: #147a44; }
    .leaf.svgOak svg .leafShape { fill: #ba8c4b; stroke: #7c5b25; }
    .leaf.svgGinko svg .leafShape { fill: #ffe763; stroke: #a59b28; }
    .leaf.svgMaple svg .leafShape { fill: #f46c35; stroke: #a93511; }
    .leaf.svgTeak svg .leafShape { fill: #8bdbc1; stroke: #177655; }
    .leaf svg { width: 100%; height: 100%; display: block; }
    .template-mtk-float {
      position: fixed !important;
      z-index: 10 !important;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: clamp(320px, 40vw, 610px);
      height: auto;
      background: none !important;
      pointer-events: none;
      user-select: none;
      -webkit-user-select: none;
      animation: floatUpDown 2.8s ease-in-out infinite;
      filter: none !important;
      transition: filter 0.18s;
    }
    @keyframes floatUpDown {
      0% { transform: translateX(-50%) translateY(0);}
      50% { transform: translateX(-50%) translateY(-22px);}
      100% { transform: translateX(-50%) translateY(0);}
    }
    .hero {
      width: 100vw;
      height: 100vh;
      min-height: 100svh;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: center;
      position: relative;
      padding-bottom: 0;
      box-sizing: border-box;
    }
    .container-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      width: 100%;
      height: 100%;
      position: relative;
      min-height: 100svh;
      pointer-events: none;
    }
    .bg-mtk-2 {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: auto;
      z-index: 1;
      opacity: 0.2;
      max-width: 100vw;
      pointer-events: none;
      user-select: none;
      -webkit-user-select: none;
    }
    * {
      box-sizing: border-box;
      font-family: 'Poppins', Arial, Helvetica, sans-serif !important;
      font-weight: 700 !important;
    }
    .area-image {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-bottom: 2.5vh;
      min-height: 0;
      min-width: 0;
      pointer-events: none;
    }
    .button-row.center-menu-buttons {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      top: 56%;
      flex-wrap: wrap;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 0;
      z-index: 22;
      background: none;
      box-sizing: border-box;
      width: auto;
      pointer-events: auto;
    }
    .main-quiz-btn {
      font-size: clamp(18px, 4vw, 30px) !important;
      min-width: clamp(190px,50vw,280px) !important;
      max-width: 92vw;
      padding: clamp(18px,2.7vw,29px) clamp(36px,7vw,75px) !important;
      margin: 0 0 clamp(22px,2.2vw,30px) 0 !important;
      border-radius: 44px !important;
      box-shadow:
        0 10px 32px 0 rgba(240, 196, 80, 0.24),
        0 8px 30px #ffe48e97,
        0 11.5px 0 #ffc94721 inset,
        0 18px 62px 0 rgba(255,191,64,0.11);
      letter-spacing: 0.01em;
      display: block;
      text-align: center;
      background: url('asset/wood.png') no-repeat center center / cover;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #632909;
      text-shadow: 0 2px 8px #fff6de, 0 1px 0 #eee, 0 2px 1.5px #c6974d11;
      border: none;
      transition:
        box-shadow 0.24s cubic-bezier(.56,.47,.56,1.20),
        transform 0.20s cubic-bezier(.53,.3,.63,1.20),
        background 0.23s;
      position: relative;
      isolation: isolate;
      overflow: hidden;
    }
    .main-quiz-btn:hover, .main-quiz-btn:focus {
      background: url('asset/wood.png') no-repeat center center / cover;
      filter: brightness(1.06) contrast(1.04);
      color: #a3570b;
      text-shadow: 0 3px 9px #fff8ed, 0 1px 0 #ffecc2;
      transform: translateY(-7px) scale(1.071);
      box-shadow:
        0 17px 46px 0 rgba(223,197,90,0.19),
        0 1.5px 12px #ffefbda2,
        0 2.5px 0 #ffe7a91b inset;
    }
    .main-quiz-btn:active {
      background: url('asset/wood.png') no-repeat center center / cover;
      filter: brightness(0.98) contrast(0.96);
      color: #8c511a;
      transform: translateY(2.5px) scale(0.97);
      box-shadow:
        0 2px 8px 0 rgba(172,157,60,0.16),
        0 0.5px 5px #FFFAECB4,
        0 1.2px 0 #ffe1af44 inset;
    }
    .below-quiz-buttons {
      display: flex;
      flex-direction: row;
      gap: clamp(15px,5vw,44px);
      justify-content: center;
      align-items: center;
      margin: 0;
      width: 100%;
    }
    .nav-btn.below-quiz {
      font-size: clamp(13px, 2vw, 17px) !important;
      min-width: clamp(160px,20vw,240px) !important;
      padding: clamp(10px,1.8vw,17px) clamp(22px,5vw,44px) !important;
      margin: 0 !important;
      border-radius: 32px !important;
      box-shadow:
        0 4px 16px 0 rgba(160, 148, 100, 0.11),
        0 1.5px 9px #fffbe4b5,
        0 1.5px 0 #e5a70014 inset,
        0 7px 20px 0 rgba(255,191,64,0.06);
      letter-spacing: 0.01em;
      text-align: center;
      display: inline-block;
    }
    .nav-btn {
      background: rgba(255,255,255,0.82);
      color: #232323;
      border: none;
      padding: var(--btn-padding-y) var(--btn-padding-x);
      font-size: var(--btn-font-size);
      border-radius: var(--btn-radius);
      cursor: pointer;
      text-decoration: none;
      font-family: 'Poppins', Arial, Helvetica, sans-serif !important;
      font-weight: 700 !important;
      box-shadow:
        0 6px 24px 0 rgba(160, 148, 100, 0.12),
        0 3px 17px #fffbe4e8,
        0 2.5px 0 #e5a70012 inset,
        0 7px 36px 0 rgba(255,191,64,0.09);
      min-width: 115px;
      max-width: 96vw;
      display: inline-block;
      margin-bottom: 0.5vh;
      word-break: break-word;
      vertical-align: middle;
      position: relative;
      outline: none;
      will-change: transform, box-shadow, background;
      transition:
        box-shadow 0.24s cubic-bezier(.56,.47,.56,1.20),
        transform 0.20s cubic-bezier(.53,.3,.63,1.20),
        background 0.23s;
      letter-spacing: 0.00em;
      backdrop-filter: blur(2.5px);
      -webkit-backdrop-filter: blur(2.5px);
    }
    .nav-btn:after {
      content: '';
      display: block;
      position: absolute;
      z-index: -2;
      left: 16%;
      right: 16%;
      bottom: -8px;
      height: 33%;
      border-radius: 32px;
      background: linear-gradient(135deg, #ffeab5ab 32%, #ffe98e19 100%);
      filter: blur(2.2px);
      opacity: .41;
      pointer-events: none;
      transition: opacity 0.19s;
    }
    .nav-btn:hover, .nav-btn:focus {
      background: rgba(255,255,255,0.96);
      color: #232323;
      transform: translateY(-7px) scale(1.071);
      box-shadow:
        0 17px 46px 0 rgba(223,197,90,0.14),
        0 1.5px 12px #ffefbda2,
        0 2.5px 0 #ffe7a91b inset;
    }
    .nav-btn:active {
      background: rgba(255,255,255,0.88);
      color: #6f591d;
      transform: translateY(2.5px) scale(0.97);
      box-shadow:
        0 2px 8px 0 rgba(172,157,60,0.16),
        0 0.5px 5px #FFFAECB4,
        0 1.2px 0 #ffe1af44 inset;
    }
    .nav-btn::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      border-radius: inherit;
      box-shadow:
        0 1.1px 1.7px 0 rgba(224, 214, 160, 0.08) inset,
        0 0.5px 2px 0 #fff7ddb3 inset;
      z-index: 1;
      pointer-events: none;
    }
    .custom-bottom-bar { display: none !important; }
    .copyright-text {
      font-family: 'Poppins';
      font-weight: 300 !important;
      margin-bottom: 8px;
      margin-top: 0;
      letter-spacing: 0.02em;
      background: transparent;
      color: #00000096;
      z-index: 65500;
      position: relative;
      padding-bottom: 3px;
      display: block;
    }
    .copyright-container {
      width: 100vw;
      position: fixed;
      left: 0;
      bottom: 0;
      z-index: 99999;
      background: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      pointer-events: none;
    }
    .copyright-container .copyright-text {
      margin-bottom: clamp(16px, 2vw, 22px);
    }
    .audio-aboutme-header-btn-container {
      position: fixed;
      top: 18px;
      left: 1%;
      z-index: 34500;
      pointer-events: none;
      display: flex;
      align-items: center;
      gap: 18px;
    }
    .audio-aboutme-header-btn-container > * { pointer-events: auto; }
    /* Tombol info kanan atas style + modal mini style */
    .info-top-right-btn {
      width: var(--audio-btn-size);
      height: var(--audio-btn-size);
      background: var(--audio-btn-bg);
      box-shadow: var(--audio-btn-shadow);
      border-radius: var(--audio-btn-radius);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      transition: box-shadow 0.19s, background 0.18s;
      z-index: 34002;
      position: absolute;
      right: 1%;
      top: 0;
    }
    .info-top-right-btn:active { background: #ffe7a857; }
    .info-top-right-btn svg {
      display: block;
      width: 26px;
      height: 26px;
    }

    /* MINI INFO MODAL CENTERED WITH ANIMATION */
    .mini-info-modal-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(30,24,0,0.13);
      z-index: 350001;
      display: none;
      justify-content: center;
      align-items: center;
      transition: background 0.35s cubic-bezier(.4,0,.2,1), opacity 0.28s cubic-bezier(.4,0,.2,1);
      opacity: 0;
      pointer-events: none;
    }
    .mini-info-modal-overlay.show {
      display: flex;
      opacity: 1;
      pointer-events: all;
      animation: fadeInMiniModalBg .33s;
      transition: background .33s cubic-bezier(.39,0,.65,1), opacity .28s cubic-bezier(.4,0,.2,1);
    }
    /* Animate out with .mini-info-modal-overlay.hide */
    .mini-info-modal-overlay.hide {
      opacity: 0 !important;
      pointer-events: none;
      transition: background 0.38s cubic-bezier(.39,0,.65,1), opacity 0.33s cubic-bezier(.4,0,.2,1);
      /* Keep display:flex to allow animating opacity */
    }
    @keyframes fadeInMiniModalBg {
      0% { opacity: .0; background: rgba(30,24,0,0);}
      100% { opacity: 1; background: rgba(30,24,0,0.13);}
    }

    .mini-info-modal {
      background: #fffbe4;
      border-radius: 17px;
      box-shadow: 0 4px 24px #ecdc9799,0 6px 31px #fffbe4e3;
      max-width: 395px;
      width: clamp(230px, 80vw, 395px);
      padding: 20px 24px 18px 20px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      position: relative;
      font-family: 'Poppins', Arial, Helvetica, sans-serif;
      font-weight: 400;
      font-size: 13px;
      color: #564419;
      opacity: 1;
      min-height: 80px;
      line-height: 1.6;

      /* Center animation effect */
      opacity: 0;
      transform: scale(0.92) translateY(37px);
      transition: opacity 0.27s cubic-bezier(.47,.16,.53,1.05), transform 0.36s cubic-bezier(.55,.15,.54,1.1);
      will-change: opacity, transform;
    }
    /* Tambahan agar logo tampil kanan atas modal mini info */
    .mini-info-modal .mini-info-logo {
      position: absolute;
      top: 13px;
      right: 16px;
      width: 42px;
      height: 42px;
      object-fit: contain;
      z-index: 25;
      border-radius: 50%;
      box-shadow: 0 1.5px 5px #ffeab5ba;
      background: #fffbeae7;
    }
    /* Responsive kecil */
    @media (max-width: 460px) {
      .mini-info-modal .mini-info-logo {
        width: 30px;
        height: 30px;
        top: 7px;
        right: 10px;
      }
    }
    /* GESER TEKS POPUP KE BAWAH */
    .mini-info-modal .mini-info-modal-content-inner {
      margin-top: 34px;
    }
    @media (max-width: 460px) {
      .mini-info-modal .mini-info-modal-content-inner {
        margin-top: 24px;
      }
    }
    .mini-info-modal-overlay.show .mini-info-modal {
      opacity: 1;
      transform: scale(1) translateY(0);
      transition: opacity 0.29s cubic-bezier(.47,.16,.53,1.05), transform 0.39s cubic-bezier(.45,.14,.56,1.17);
    }
    .mini-info-modal-overlay.hide .mini-info-modal {
      opacity: 0;
      transform: scale(0.94) translateY(32px);
      transition: opacity 0.27s cubic-bezier(.44,.22,.59,.99), transform 0.41s cubic-bezier(.45,.14,.46,1.10);
    }

    .mini-info-modal .close-btn-miniinfo {
      /* The close button is now at the bottom, not absolutely positioned */
      position: static;
      margin: 20px auto 0 auto;
      display: block;
      width: auto;
      height: auto;
      min-width: 84px;
      padding: 8px 24px 7px 24px;
      background: #ffeab5;
      color: #b6890a;
      font-weight: 500;
      font-size: 1em;
      border-radius: 15px;
      border: none;
      cursor: pointer;
      transition: background 0.17s, color 0.17s;
      box-shadow: 0 2px 14px #ffeab577, 0 1px 4px #ffeab577;
      z-index: 11;
      text-align: center;
    }
    .mini-info-modal .close-btn-miniinfo:active,
    .mini-info-modal .close-btn-miniinfo:hover {
      background: #ffe7a8;
      color: #e5a700;
    }
    .mini-info-modal .close-btn-miniinfo svg {
      display: none;
    }
    .mini-info-modal .close-btn-miniinfo .btn-label {
      display: inline-block;
      font-family: 'Poppins', Arial, Helvetica, sans-serif;
      font-weight: 500;
      font-size: 1em;
      letter-spacing: 0.03em;
      color: inherit;
      text-shadow: 0 1.5px 8px #fffbd6b7;
      vertical-align: middle;
    }
    .mini-info-modal h2 {
      color: #b6890a;
      font-size: 1.08em;
      font-weight: 400;
      margin: 0 0 7px 0;
      letter-spacing: 0.03em;
      padding-bottom: 5px;
    }
    .mini-info-modal p {
      margin: 0 0 6px 0;
      font-size: 13px;
      letter-spacing: .01em;
      font-weight: 400;
    }
    .mini-info-modal strong {
      font-weight: 500;
    }
    .header-btn-container-row {
      pointer-events: none;
      position: fixed;
      top: 18px;
      right: 1%;
      left: auto;
      z-index: 34501;
      display: flex;
      align-items: center;
      gap: 18px;
    }
    .header-btn-container-row > * { pointer-events: auto; }
    @media (max-width: 700px) {
      .audio-aboutme-header-btn-container { top: 4vw; left: 1%; }
      .header-btn-container-row { top: 4vw; right: 1%; }
      .mini-info-modal { max-width: 97vw; width: 97vw; padding: 17px 5vw 13px 4vw; }
      .mini-info-modal-overlay { align-items: center; /* Center on mobile too */ }
      .mini-info-modal h2, .mini-info-modal p { font-size: 12px; }
      .mini-info-modal .close-btn-miniinfo { font-size: 15px; padding: 7px 18px; }
    }
    @media (max-width: 430px) {
      .audio-aboutme-header-btn-container { top: 2vw; left: 1%; }
      .header-btn-container-row { top: 2vw; right: 1%; }
      .mini-info-modal { margin-top: 7vw; font-size: 12px; }
      .mini-info-modal h2, .mini-info-modal p { font-size: 11.2px; }
      .mini-info-modal .close-btn-miniinfo { font-size: 12px; padding: 7px 15px; }
    }
    .aboutme-top-right-btn {
      width: var(--audio-btn-size);
      height: var(--audio-btn-size);
      background: var(--audio-btn-bg);
      box-shadow: var(--audio-btn-shadow);
      border-radius: var(--audio-btn-radius);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      transition: box-shadow 0.19s, background 0.18s;
      z-index: 34002;
    }
    .aboutme-top-right-btn:active { background: #ffe7a857; }
    .fadeout-overlay {
      position: fixed;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background: #fffbe4;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.7s cubic-bezier(.44,.05,.54,1);
      z-index: 9999999;
      will-change: opacity;
    }
    .fadeout-overlay.show {
      opacity: 1;
      pointer-events: all;
      transition: opacity 0.7s cubic-bezier(.44,.05,.54,1);
    }
    .fadein-overlay {
      position: fixed;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background: #fffbe4;
      opacity: 1;
      pointer-events: none;
      transition: opacity 0.7s cubic-bezier(.44,.05,.54,1);
      z-index: 9999998;
      will-change: opacity;
    }
    .fadein-overlay.hide {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.7s cubic-bezier(.44,.05,.54,1);
    }
    .modal-overlay {
      display: none;
      position: fixed;
      z-index: 150000;
      left: 0; top: 0; width: 100vw; height: 100vh;
      justify-content: center;
      align-items: center;
      background: rgba(30,24,0,0.21);
      transition: background 0.38s cubic-bezier(.4,0,.2,1), opacity 0.34s cubic-bezier(.4,0,.2,1);
      opacity: 0;
      pointer-events: none;
    }
    .modal-overlay.cara-main-anim {
      display: flex;
      pointer-events: all;
      opacity: 1;
      animation: fadeInModalBg 0.44s cubic-bezier(.4,0,.2,1) both;
      transition: background 0.38s cubic-bezier(.4,0,.2,1), opacity 0.34s cubic-bezier(.4,0,.2,1);
    }
    @keyframes fadeInModalBg {
      0% { background: rgba(30,24,0,0); opacity:0;}
      100% { background: rgba(30,24,0,0.21); opacity:1;}
    }
    .modal-content {
      position: relative;
      background: #fffbe4;
      border-radius: 18px;
      box-shadow: 0 8px 40px #e1d58a58, 0 2.5px 24px #fffbeddb;
      padding: 0;
      max-width: 560px;
      min-width: min(96vw,380px);
      width: 90vw;
      min-height: 120px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      opacity: 0;
      transform: translateY(48px) scale(0.97);
      transition: opacity 0.4s cubic-bezier(.47,.16,.53,1.05), transform 0.47s cubic-bezier(.55,.15,.54,1.1);
      will-change: opacity, transform;
    }
    .modal-overlay.cara-main-anim .modal-content {
      opacity: 1;
      transform: translateY(0) scale(1);
      transition: opacity 0.43s cubic-bezier(.47,.16,.53,1.05), transform 0.47s cubic-bezier(.55,.15,.54,1.1);
    }
    .close-btn {
      position: absolute;
      top: 13px;
      right: 13px;
      z-index: 2;
      background: none;
      border: none;
      cursor: pointer;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.15s;
    }
    .close-btn:hover, .close-btn:focus { background: #fffbe887; }
    .close-btn-3d .x-3d {
      display: inline-block;
      position: relative;
      width: 28px;
      height: 28px;
      pointer-events: none;
    }
    .close-btn-3d .x-bar {
      position: absolute;
      top: 13px;
      left: 3px;
      width: 22px;
      height: 3px;
      background: #d3c079;
      border-radius: 2.2px;
      box-shadow: 0 1px 3.5px #eed;
    }
    .close-btn-3d .x-bar:first-child { transform: rotate(45deg); }
    .close-btn-3d .x-bar:last-child { transform: rotate(-45deg); }
    .mute-toggle-btn {
      width: var(--audio-btn-size);
      height: var(--audio-btn-size);
      background: var(--audio-btn-bg);
      box-shadow: var(--audio-btn-shadow);
      border-radius: var(--audio-btn-radius);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      transition: box-shadow 0.19s, background 0.18s;
      z-index: 402;
      pointer-events: auto;
    }
    .mute-toggle-btn:active { background: #ffe7a857; }
    .audio-dropdown-container {
      position: absolute;
      top: 80px;
      left: 0px;
      z-index: 34000;
      user-select: none;
      pointer-events: none;
      width: 100%;
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
    }
    .audio-dropdown {
      pointer-events: none;
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-width: 145px;
      background: #fffbe4f3;
      box-shadow: 0 6px 26px #cfbf70a9;
      border-radius: 17px;
      margin-top: 0px;
      margin-left: 68px;
      padding: 15px 18px 16px 20px;
      z-index: 1;
      position: absolute;
      left: 0; top: 0;
      opacity: 0;
      transform: translateY(-14px) scale(0.96);
      transition: opacity 0.24s, transform 0.32s;
    }
    .audio-dropdown.show {
      pointer-events: auto;
      opacity: 1;
      transform: translateY(0) scale(1);
      transition: opacity 0.27s, transform 0.38s cubic-bezier(.55,.38,.54,1.13);
    }
    .audio-volume-slider-wrap { display: flex; align-items: center; gap: 8px; }
    .audio-volume-min, .audio-volume-max { font-size: 0.97em; color: #aa8a27; }
    .audio-volume-mute-mini {
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      margin-right: 1px;
      margin-left: 2px;
      width: 19px;
      height: 20px;
      background: none;
      border: none;
      outline: none;
      box-shadow: none;
      padding: 0 !important;
      transition: background 0.18s;
    }
    .audio-volume-mute-mini:active {
      background: #ffe7a857;
      border-radius: 12px;
    }
    .audio-volume-mute-mini svg {
      display: block;
      width: 16px;
      height: 16px;
      min-width: 16px;
      min-height: 16px;
      stroke: #FBB904;
      transition: stroke 0.16s;
    }
    .audio-volume-mute-mini.muted svg { stroke: #999; }
    .audio-volume-slider {
      accent-color: var(--volume-slider-orange-dark);
      width: 100px;
      height: 5px;
      border-radius: 6px;
      background: none;
      outline: none;
      margin: 0 6px;
    }
    .audio-volume-slider::-webkit-slider-runnable-track {
      height: 5px;
      border-radius: 4px;
      background: linear-gradient(90deg, var(--volume-slider-orange-dark), var(--volume-slider-orange-dark-light));
    }
    .audio-volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--volume-slider-orange-dark);
      border: 2px solid #fffbe4;
      box-shadow: 0 2px 6px #ce8a1c42;
      cursor: pointer;
      margin-top: -5.5px;
      transition: background 0.15s;
    }
    .audio-volume-slider:focus::-webkit-slider-thumb {
      background: #a95f08;
      outline: 2px solid var(--volume-slider-orange-dark);
    }
    .audio-volume-slider::-webkit-slider-thumb:hover,
    .audio-volume-slider:active::-webkit-slider-thumb { background: #a95f08; }
    .audio-volume-slider::-moz-range-track {
      height: 5px;
      border-radius: 4px;
      background: linear-gradient(90deg, var(--volume-slider-orange-dark), var(--volume-slider-orange-dark-light));
    }
    .audio-volume-slider::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--volume-slider-orange-dark);
      border: 2px solid #fffbe4;
      box-shadow: 0 2px 6px #ce8a1c42;
      cursor: pointer;
      transition: background 0.15s;
    }
    .audio-volume-slider:focus::-moz-range-thumb {
      background: #a95f08;
      outline: 2px solid var(--volume-slider-orange-dark);
    }
    .audio-volume-slider::-moz-range-thumb:hover,
    .audio-volume-slider:active::-moz-range-thumb { background: #a95f08; }
    .audio-volume-slider:focus {
      outline: none;
      box-shadow: 0 0 0 2px var(--volume-slider-orange-dark-light);
    }
    @media (max-width: 600px) {
      .audio-volume-slider { width: 70px; }
      .audio-dropdown-container { top: 64px; }
    }
    @media (max-width: 700px) {
      .modal-content { max-width: 100vw; width: 100vw; }
      .modal-content iframe { height: 62vh !important; }
      .close-btn { width: 30px; height: 30px; }
      .close-btn-3d .x-3d { width: 22px; height: 22px; }
      .nav-btn {
        font-size: 14px;
        min-width: 88px;
        padding: 12px 6vw;
      }
      .button-row.center-menu-buttons { top: 14%; }
      .main-quiz-btn {
        font-size: 14px !important;
        min-width: 58vw !important;
        padding: 12px 5vw !important;
        margin-bottom: 10px !important;
      }
      .below-quiz-buttons { gap: 7vw; }
      .nav-btn.below-quiz {
        font-size: 13px !important;
        min-width: 46vw !important;
        padding: 11px 5vw !important;
      }
      .audio-dropdown-container { top: 64px; }
    }
    @media (max-width: 430px) {
      .modal-content { max-width: 100vw; width: 100vw; }
      .modal-content iframe { height: 50vh !important; }
      .close-btn { width: 26px; height: 26px;}
      .close-btn-3d .x-3d { width: 16px; height: 16px; }
      .copyright-container .copyright-text {
        font-size: 13px !important;
        margin-bottom: 10px;
      }
      .button-row.center-menu-buttons { top: 7%; }
      .main-quiz-btn {
        font-size: 11.5px !important;
        min-width: 47vw !important;
        padding: 8px 4vw !important;
        margin-bottom: 5px !important;
      }
      .below-quiz-buttons { gap: 4vw; }
      .nav-btn.below-quiz {
        font-size: 12px !important;
        min-width: 36vw !important;
        padding: 7px 5vw !important;
      }
      .audio-dropdown-container { top: 52px; }
    }
  </style>
</head>
<body>
  <div class="falling-leaves-container" id="leavesContainer"></div>
  <div class="fadeout-overlay" id="fadeoutOverlay"></div>
  <div class="fadein-overlay" id="fadeinOverlay"></div>
  <img src="asset/template matematika.png" alt="Template Matematika" class="template-mtk-float" draggable="false" style="background: none;" />
  <div class="audio-aboutme-header-btn-container">
    <a class="aboutme-top-right-btn" id="aboutMeBtn-top" aria-label="About Me" title="About Me" href="about-us.html">
      <svg viewBox="0 0 32 32" width="26" height="26">
        <circle cx="16" cy="12" r="7" fill="#ffe07b" stroke="#fbbc04" stroke-width="2"/>
        <ellipse cx="16" cy="24.5" rx="10" ry="7" fill="#fff9ea" stroke="#fbbc04" stroke-width="2"/>
        <ellipse cx="16" cy="12" rx="7" ry="7" fill="none" stroke="#e5a700" stroke-width="1.4"/>
        <ellipse cx="16" cy="24.5" rx="10" ry="7" fill="none" stroke="#e5a700" stroke-width="1.4"/>
      </svg>
    </a>
    <button id="muteToggleBtn" class="mute-toggle-btn" aria-label="Mute / Unmute Audio" title="Mute / Unmute">
      <svg id="icon-mute-toggle" viewBox="0 0 24 24" fill="none" stroke="#FBB904" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="24" height="24">
        <polygon id="icon-mute-toggle-polygon" points="9 9 13 9 17 5 17 19 13 15 9 15 9 9"/>
        <line id="icon-mute-toggle-line" x1="19" y1="5" x2="19" y2="19"></line>
      </svg>
    </button>
  </div>
  <div class="header-btn-container-row">
    <a class="info-top-right-btn" id="infoBtn-top" aria-label="Informasi" title="Informasi" href="#">
      <svg viewBox="0 0 32 32" width="26" height="26">
        <circle cx="16" cy="16" r="15" fill="#fff9ea" stroke="#fbbc04" stroke-width="2"/>
        <ellipse cx="16" cy="16" rx="15" ry="15" fill="none" stroke="#e5a700" stroke-width="1.4"/>
        <text x="16" y="22" text-anchor="middle" font-size="18" font-family="Arial, Helvetica, sans-serif" fill="#e5a700" dominant-baseline="middle" style="font-weight:400">i</text>
      </svg>
    </a>
  </div>
  <!-- Modal mini Info -->
  <div class="mini-info-modal-overlay" id="miniInfoModal">
    <div class="mini-info-modal" role="dialog" aria-modal="true" aria-labelledby="infoTitle">
      <img src="asset/logo.png" alt="Logo" class="mini-info-logo" loading="lazy" />
      <div class="mini-info-modal-content-inner">
        <h2 id="infoTitle">INFORMASI</h2>
        <p>
          <p style="text-align: justify; font-weight: 300; font-family: 'Poppins', Arial, Helvetica, sans-serif;">
            Game Ular Tangga Operasi Hitung Campuran adalah media pembelajaran web interaktif untuk siswa SD kelas III.<br>
            Melalui permainan ular tangga, siswa belajar memahami konsep operasi hitung campuran dengan menjawab soal di setiap langkah.<br>
            Game ini juga dilengkapi video penjelasan menarik, tampilan ramah anak, dan gameplay sederhana yang membuat belajar matematika terasa seru.<br>
          </p>
        </p>
        <button class="close-btn-miniinfo" id="closeMiniInfoBtn" aria-label="Tutup">
          <span class="btn-label">Tutup</span>
        </button>
      </div>
    </div>
  </div>
  <div class="audio-dropdown-container" style="position:absolute;left:0;top:80px;width:350px;max-width:90vw;">
    <div id="audioDropdown" class="audio-dropdown">
      <div class="audio-volume-slider-wrap">
        <button class="audio-volume-mute-mini" id="audioMuteMiniBtn" type="button" aria-label="Mute/Unmute (Mini)">
          <svg id="audioMuteMiniIcon" viewBox="0 0 24 24" fill="none" stroke="#FBB904" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon id="audioMuteMiniPoly" points="9 9 13 9 17 5 17 19 13 15 9 15 9 9"/>
            <line id="audioMuteMiniLine" x1="19" y1="5" x2="19" y2="19"></line>
          </svg>
        </button>
        <span class="audio-volume-min">0</span>
        <input type="range" min="0" max="100" value="100" class="audio-volume-slider" id="audioVolumeSlider" aria-label="Volume" />
        <span class="audio-volume-max">100</span>
      </div>
    </div>
  </div>
  <audio id="backgroundAudio" src="audio.mp3" loop></audio>
  <section id="hero" class="hero">
    <div class="container-center">
      <img src="asset/background ke 2 matematika.png" class="bg-mtk-2" alt="" style="pointer-events:none;max-width:100vw;height:auto;display:block;" />
      <div class="area-image"></div>
      <div class="button-row center-menu-buttons">
        <a class="nav-btn main-quiz-btn" id="quizBtn" href="#">Quiz</a>
        <div class="below-quiz-buttons">
          <a class="nav-btn below-quiz" id="materiBtn" href="#">Materi</a>
          <button class="nav-btn below-quiz" id="caraMainBtn" type="button">Cara Bermain</button>
        </div>
      </div>
    </div>
    <div class="custom-bottom-bar">
      <div class="button-row">
        <a class="nav-btn main-quiz-btn" id="quizBtn-bar" href="#">Quiz</a>
        <a class="nav-btn below-quiz" id="materiBtn-bar" href="#">Materi</a>
        <button class="nav-btn below-quiz" id="caraMainBtn-bar" type="button">Cara Bermain</button>
        <button class="nav-btn" id="aboutMeBtn-bar" type="button">About Me</button>
      </div>
    </div>
    <div class="copyright-container" style="font-family: 'Poppins', Arial, Helvetica, sans-serif; font-size: 13px; font-weight: normal; color: #444;">
      <span class="copyright-text" style="font-family: Arial, Helvetica, sans-serif; font-weight: 400; font-style: normal;">&copy; <span id="copyright-year">
         </span> Rossy Fadhilah</span>
    </div>
    <div id="aboutMeModal" class="modal-overlay" style="display:none;">
      <div class="modal-content">
        <button class="close-btn close-btn-3d" id="closeAboutMe" aria-label="Tutup">
          <span class="x-3d">
            <span class="x-bar"></span>
            <span class="x-bar"></span>
          </span>
        </button>
        <iframe src="about-us.html" style="width:100%;height:80vh;border:none;border-radius:12px;background:white;font-family:'Poppins',Arial,Helvetica,sans-serif;font-weight:700;max-width:100vw;"></iframe>
      </div>
    </div>
    <div id="caraMainModal" class="modal-overlay">
      <div class="modal-content" tabindex="-1">
        <button class="close-btn close-btn-3d" id="closeCaraMain" aria-label="Tutup" style="background: rgba(255, 255, 255, 0.65); transition: box-shadow 0.25s;">
          <style>
            #closeCaraMain .x-3d .x-bar {
              background: #e29120 !important;
              transition: background 0.2s;
            }
            #closeCaraMain:hover {
              box-shadow: 0 0 14px 4px rgba(226,145,32,0.55), 0 2px 16px rgba(255,190,62,0.28);
            }
            #closeCaraMain:hover .x-3d .x-bar {
              background: #c67112 !important;
            }
          </style>
          <span class="x-3d">
            <span class="x-bar"></span>
            <span class="x-bar"></span>
          </span>
        </button>
        <iframe src="game-rules.html" style="width:100%;height:80vh;border:none;border-radius:12px;background:rgb(255, 255, 255);font-family:'Poppins',Arial,Helvetica,sans-serif;font-weight:700;max-width:100vw;"></iframe>
      </div>
    </div>
    <script>
      document.documentElement.style.overflow = 'hidden';
      document.body.style.overflow = 'hidden';
      document.getElementById('muteToggleBtn').style.pointerEvents = 'auto';
      document.getElementById('aboutMeBtn-top').style.pointerEvents = 'auto';
      var infoBtnTop = document.getElementById('infoBtn-top');
      if (infoBtnTop) infoBtnTop.style.pointerEvents = 'auto';

      (function fallingLeaves(){
        //... LEAVES CODE (no change)
        const leafVariants = [
          {
            svg: `<svg viewBox="0 0 36 38">
              <path class="leafShape" d="M18,2 C16,11 3,13 2,23 C1,31 12,36 19,36 C27,36 34,30 33,20 C32,10 21,9 18,2 Z"/>
              <path d="M18 6 Q15 20 19 36" stroke="#a07246" stroke-width="1.5" fill="none"/>
            </svg>`,
            class: "dry"
          },
          {
            svg: `<svg viewBox="0 0 36 38">
              <path class="leafShape" d="M18,4 C14,12 5,15 5,25 C5,32 18,36 23,31 C29,25 34,17 26,11 C23,9 20,4 18,4 Z"/>
              <path d="M18 8 Q17 23 23 31" stroke="#3a8035" stroke-width="1.5" fill="none"/>
            </svg>`,
            class: "green"
          },
          {
            svg: `<svg viewBox="0 0 38 38">
              <path class="leafShape" d="M19 2 L22 12 L34 10 L26 17 L36 19 L26 21 L32 29 L22.5 23.5 L21 36 L19 24 L17 36 L15.5 23.5 L6 29 L12 21 L2 19 L12 17 L4 10 L16 12 Z" />
            </svg>`,
            class: "svgMaple"
          },
          {
            svg: `<svg viewBox="0 0 40 38">
              <path class="leafShape" d="M20,2 C17,7 7,6 9,13 C3,15 7,20 13,18 C7,25 16,24 17,22 C13,33 27,32 23,22 C31,25 32,15 27,15 C34,13 31,6 25,10 C24,6 20,2 20,2 Z"/>
            </svg>`,
            class: "svgOak"
          },
          {
            svg: `<svg viewBox="0 0 36 40">
              <path class="leafShape" d="M30,8 Q22,6 14,19 Q13,3 6,6 Q11,19 13,37 Q22,38 29,19 Q23,29 15,32 Q27,27 30,8 Z"/>
            </svg>`,
            class: "banana"
          },
          {
            svg: `<svg viewBox="0 0 36 38">
              <path class="leafShape" d="M21,5 Q32,9 29,17 Q35,15 28,25 Q36,28 24,32 Q32,37 16,34 Q11,38 8,26 Q2,28 7,17 Q2,14 14,10 Q7,7 17,5 Q13,3 18,5 Q23,2 21,5 Z"/>
            </svg>`,
            class: "monstera"
          },
          {
            svg: `<svg viewBox="0 0 36 34">
              <path class="leafShape" d="M18,31 Q12,23 5,20 Q1,10 8,3 Q14,3 18,9 Q22,3 28,3 Q35,10 31,20 Q24,23 18,31 Z"/>
            </svg>`,
            class: "svgGinko"
          },
          {
            svg: `<svg viewBox="0 0 38 38">
              <path class="leafShape" d="M19 2 L21 11 L36 8 L26 15 L36 20 L26 22 L32 32 L21.5 24.5 L21 36 L19 25 L17 36 L16.5 24.5 L6 32 L11 22 L2 20 L12 15 L2 8 L17 11 Z" />
            </svg>`,
            class: "orange"
          },
          {
            svg: `<svg viewBox="0 0 38 38">
              <path class="leafShape" d="M19 3 L22 9 L33 8 L26 16 L33 18 L26 21 L32 29 L22.5 21.5 L19 36 L15.5 21.5 L6 29 L11 21 L3 18 L10 16 L3 8 L16 9 Z" />
            </svg>`,
            class: "yellow"
          },
          {
            svg: `<svg viewBox="0 0 34 38">
              <path class="leafShape" d="M17,3 Q4,22 17,35 Q30,22 17,3 Z" />
            </svg>`,
            class: "purple"
          },
          {
            svg: `<svg viewBox="0 0 40 40">
              <path class="leafShape" d="M20,7 Q8,24 20,38 Q32,24 20,7 Z" />
            </svg>`,
            class: "svgTeak"
          }
        ];

        const leavesContainer = document.getElementById('leavesContainer');
        //... omitting unchanged code for brevity
        const screenW = () => window.innerWidth || document.documentElement.clientWidth;
        const screenH = () => window.innerHeight || document.documentElement.clientHeight;

        // ... rest of unchanged fallingLeaves
        // [same as your code]
        function randomBetween(a, b) { return a + Math.random() * (b - a); }
        function createLeaf() {/* ... unchanged ... */ }
        let leafTimer = null;
        function spawnLeaves() {/* ... unchanged ... */}
        document.addEventListener('DOMContentLoaded', () => { spawnLeaves(); });
      })();

      document.addEventListener('DOMContentLoaded', function () {
        function forwardClick(idFrom, idTo) {
          const src = document.getElementById(idFrom);
          const dest = document.getElementById(idTo);
          if (src && dest) {
            src.onclick = e => { e.preventDefault(); dest.click(); };
          }
        }
        forwardClick('quizBtn-bar', 'quizBtn');
        forwardClick('materiBtn-bar', 'materiBtn');
        forwardClick('caraMainBtn-bar', 'caraMainBtn');

        var aboutMeBtnTop = document.getElementById('aboutMeBtn-top');
        var fadeoutOverlay = document.getElementById('fadeoutOverlay');
        if (aboutMeBtnTop && fadeoutOverlay) {
          aboutMeBtnTop.addEventListener('click', function (e) {
            if (aboutMeBtnTop.getAttribute('href') === 'about-us.html' && e.button === 0 && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey) {
              e.preventDefault();
              try { sessionStorage.setItem('aboutme_returned', '1'); } catch (err) { }
              fadeoutOverlay.classList.add('show');
              setTimeout(function () {
                window.location.href = aboutMeBtnTop.getAttribute('href');
              }, 700);
            }
          }, false);
        }

        // Informasi modal open/close logic - REWRITTEN for smooth center open/close
        var infoBtnTop = document.getElementById('infoBtn-top');
        var miniInfoModal = document.getElementById('miniInfoModal');
        var closeMiniInfoBtn = document.getElementById('closeMiniInfoBtn');
        let animInfoModalTimeout = null;

        function openMiniInfoModal(){
          if (!miniInfoModal) return;
          miniInfoModal.classList.remove("hide");
          miniInfoModal.style.display = "flex";
          // Ensure styles are applied before adding .show for transition effect
          setTimeout(function(){
            miniInfoModal.classList.add("show");
            if (closeMiniInfoBtn) setTimeout(()=>closeMiniInfoBtn.focus(), 150);
          }, 10);
          document.body.style.overflow = 'hidden';
          document.documentElement.style.overflow = 'hidden';
        }
        function hideMiniInfoModal(){
          if (!miniInfoModal) return;
          miniInfoModal.classList.remove("show");
          miniInfoModal.classList.add("hide");
          // After animation, hide display
          clearTimeout(animInfoModalTimeout);
          animInfoModalTimeout = setTimeout(function(){
            miniInfoModal.style.display = '';
            miniInfoModal.classList.remove("hide");
          }, 340);
          document.body.style.overflow = 'hidden';
          document.documentElement.style.overflow = 'hidden';
        }

        if (infoBtnTop && miniInfoModal) {
          infoBtnTop.addEventListener('click', function(e){
            e.preventDefault();
            openMiniInfoModal();
          });
        }
        if (closeMiniInfoBtn && miniInfoModal) {
          closeMiniInfoBtn.addEventListener('click', function() {
            hideMiniInfoModal();
          });
        }
        // Tutup info modal jika backdrop diklik
        if (miniInfoModal) {
          miniInfoModal.addEventListener('mousedown', function(e){
            if (e.target === miniInfoModal) {
              hideMiniInfoModal();
            }
          });
          // keyboard esc
          document.addEventListener('keydown', function(e){
            if (
              miniInfoModal.classList.contains('show') &&
              (e.key === 'Escape' || e.key === 'Esc')
            ) {
              e.preventDefault();
              hideMiniInfoModal();
            }
          });
        }

        var caraBtn = document.getElementById('caraMainBtn');
        var caraModal = document.getElementById('caraMainModal');
        var closeCara = document.getElementById('closeCaraMain');
        function openCara() {
          caraModal.style.display = "flex";
          requestAnimationFrame(function () {
            caraModal.classList.add('cara-main-anim');
          });
          document.body.style.overflow = 'hidden';
          document.documentElement.style.overflow = 'hidden';
        }
        function closeCaraFn() {
          caraModal.classList.remove('cara-main-anim');
          setTimeout(function () {
            caraModal.style.display = "none";
          }, 440);
          document.body.style.overflow = 'hidden';
          document.documentElement.style.overflow = 'hidden';
        }
        if (caraBtn) caraBtn.onclick = openCara;
        if (closeCara) closeCara.onclick = closeCaraFn;
        if (caraModal) {
          caraModal.onclick = function (e) {
            if (e.target === caraModal) closeCaraFn();
          };
        }
        var caraBarBtn = document.getElementById('caraMainBtn-bar');
        if (caraBarBtn) caraBarBtn.onclick = function (e) { e.preventDefault(); openCara(); };

        document.addEventListener('keydown', function (evt) {
          if (caraModal && caraModal.classList.contains('cara-main-anim')) {
            if (evt.key === "Escape" || evt.key === "Esc") {
              evt.preventDefault(); closeCaraFn();
            }
          }
        });

        var quizBtn = document.getElementById('quizBtn');
        if (quizBtn) {
          quizBtn.addEventListener('click', function (e) {
            e.preventDefault();
            window.location.href = "ulartangga.html";
          });
        }
        var materiBtn = document.getElementById('materiBtn');
        var fadeoutOverlay = document.getElementById('fadeoutOverlay');
        if (materiBtn) {
          materiBtn.addEventListener('click', function (e) {
            e.preventDefault();
            if (fadeoutOverlay) {
              fadeoutOverlay.classList.add('show');
              setTimeout(function () {
                window.location.href = "materi-page.html";
              }, 700);
            } else {
              window.location.href = "materi-page.html";
            }
          });
        }
        var fadeinOverlay = document.getElementById('fadeinOverlay');
        if (fadeinOverlay) {
          if (sessionStorage.getItem('aboutme_returned') === '1') {
            fadeinOverlay.classList.remove('hide');
            try { sessionStorage.removeItem('aboutme_returned'); } catch (e) { }
            setTimeout(function () {
              fadeinOverlay.classList.add('hide');
              setTimeout(function () {
                fadeinOverlay.style.display = 'none';
              }, 750);
            }, 25);
          } else {
            fadeinOverlay.classList.add('hide');
            setTimeout(function () {
              fadeinOverlay.style.display = 'none';
            }, 50);
          }
        }
      });

      document.addEventListener('DOMContentLoaded', function () {
        var audio = document.getElementById('backgroundAudio');
        var muteBtn = document.getElementById('muteToggleBtn');
        var iconMain = document.getElementById('icon-mute-toggle');
        var iconPolygonMain = document.getElementById('icon-mute-toggle-polygon');
        var iconLineMain = document.getElementById('icon-mute-toggle-line');
        var audioDropdown = document.getElementById('audioDropdown');
        var audioVolumeSlider = document.getElementById('audioVolumeSlider');
        var audioMuteMiniBtn = document.getElementById('audioMuteMiniBtn');
        var audioMuteMiniIcon = document.getElementById('audioMuteMiniIcon');
        var audioMuteMiniPoly = document.getElementById('audioMuteMiniPoly');
        var audioMuteMiniLine = document.getElementById('audioMuteMiniLine');

        var LS_MUTED = 'mtkgame-audio-muted';
        var LS_VOLUME = 'mtkgame-audio-volume';

        var savedAudioState = localStorage.getItem(LS_MUTED);
        var savedAudioVolume = localStorage.getItem(LS_VOLUME);

        if (savedAudioState === "true") {
          audio.muted = true;
        } else {
          audio.muted = false;
        }
        if (savedAudioVolume) {
          var v = parseFloat(savedAudioVolume);
          if (!isNaN(v)) {
            audio.volume = v / 100;
            audioVolumeSlider.value = Math.round(v);
          }
        } else {
          audio.volume = 1;
          audioVolumeSlider.value = 100;
        }

        function setMuteIcon(isMuted, svgElem, polyElem, lineElem) {
          if (!svgElem || !polyElem || !lineElem) return;
          if (isMuted) {
            polyElem.setAttribute("points", "9 9 13 9 17 5 17 19 13 15 9 15 9 9 9 9");
            lineElem.setAttribute("x1", "1");
            lineElem.setAttribute("y1", "1");
            lineElem.setAttribute("x2", "23");
            lineElem.setAttribute("y2", "23");
            svgElem.setAttribute("stroke", "#999");
          } else {
            polyElem.setAttribute("points", "9 9 13 9 17 5 17 19 13 15 9 15 9 9");
            lineElem.setAttribute("x1", "19");
            lineElem.setAttribute("y1", "5");
            lineElem.setAttribute("x2", "19");
            lineElem.setAttribute("y2", "19");
            svgElem.setAttribute("stroke", "#FBB904");
          }
        }
        function renderAudioIcons() {
          setMuteIcon(audio.muted, iconMain, iconPolygonMain, iconLineMain);
          setMuteIcon(audio.muted, audioMuteMiniIcon, audioMuteMiniPoly, audioMuteMiniLine);
          if (audioMuteMiniBtn) {
            if (audio.muted) audioMuteMiniBtn.classList.add('muted');
            else audioMuteMiniBtn.classList.remove('muted');
          }
        }
        renderAudioIcons();

        function playAudioAlways() {
          if (!audio.muted) {
            audio.play().then(function () { })
              .catch(function () { });
          }
        }
        setInterval(playAudioAlways, 2000);
        window.addEventListener("pointerdown", playAudioAlways, { once: true, passive: true });
        window.addEventListener("keydown", playAudioAlways, { once: true, passive: true });
        setTimeout(playAudioAlways, 200);

        let dropdownOpen = false;
        function showDropdown() {
          dropdownOpen = true;
          audioDropdown.classList.add('show');
          setTimeout(() => {
            audioDropdown.style.pointerEvents = "auto";
          }, 40);
          document.body.addEventListener('mousedown', closeDropdownOnBody, true);
          document.body.addEventListener('touchstart', closeDropdownOnBody, true);
        }
        function hideDropdown() {
          dropdownOpen = false;
          audioDropdown.classList.remove('show');
          audioDropdown.style.pointerEvents = "none";
          setTimeout(() => {
            document.body.removeEventListener('mousedown', closeDropdownOnBody, true);
            document.body.removeEventListener('touchstart', closeDropdownOnBody, true);
          }, 300);
        }
        let closeDropdownOnBody = function (e) {
          if (!dropdownOpen) return;
          let t = e.target;
          if (!muteBtn.contains(t) && !audioDropdown.contains(t)) {
            hideDropdown();
          }
        };

        muteBtn.addEventListener('click', function (evt) {
          evt.preventDefault();
          evt.stopPropagation();
          if (dropdownOpen) {
            hideDropdown();
          } else {
            showDropdown();
          }
        });

        if (audioMuteMiniBtn) {
          audioMuteMiniBtn.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            audio.muted = !audio.muted;
            if (audio.muted) {
              localStorage.setItem(LS_MUTED, "true");
              audio.pause();
            } else {
              localStorage.setItem(LS_MUTED, "false");
              playAudioAlways();
            }
            renderAudioIcons();
          });
        }

        audioVolumeSlider.addEventListener('input', function () {
          let val = Number(audioVolumeSlider.value);
          let v = isNaN(val) ? 1 : Math.max(0, Math.min(val, 100));
          audio.volume = v / 100;
          localStorage.setItem(LS_VOLUME, String(v));
          if (v === 0) {
            audio.muted = true;
            localStorage.setItem(LS_MUTED, "true");
            audio.pause();
          } else {
            if (audio.muted) {
              audio.muted = false;
              localStorage.setItem(LS_MUTED, "false");
              playAudioAlways();
            }
          }
          renderAudioIcons();
        });

        audio.addEventListener('volumechange', function () {
          let volumePct = Math.round(audio.volume * 100);
          if (Number(audioVolumeSlider.value) !== volumePct) {
            audioVolumeSlider.value = volumePct;
          }
          renderAudioIcons();
        });

        document.addEventListener('keydown', function (ev) {
          if (dropdownOpen && ev.key === "Escape") hideDropdown();
        });
        window.addEventListener('resize', function () {
          if (dropdownOpen) hideDropdown();
        });
      });

      document.addEventListener('DOMContentLoaded', function () {
        var yearNow = new Date().getFullYear();
        var cy = document.getElementById('copyright-year');
        if (cy) cy.textContent = yearNow;
      });
    </script>
  </section>
</body>
</html>